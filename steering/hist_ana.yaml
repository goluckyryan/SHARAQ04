alias:
  vertexGate: TMath::Abs(vertex.fZ-10)<60
  tofDSGate: TMath::Abs(tof_D1.fTiming-35)<10
  commonGate: gate.Test(0) & TMath::Abs(tof_D1.fTiming-40)<10 & TMath::Abs(vertex.fZ-10)<60
  tgtGate: gate.Test(9)
  holderGate: gate.Test(11) & !gate.Test(9)
  nyokiIDGate: abs(nyoki.fID-8)<=2
  nyokiQGate: 1000 < nyoki.fCharge # don't know why does not work
  openPhiGate: TMath::Abs(TMath::Abs(p2p.fRecoilL.Phi()-p2p.fRecoilR.Phi())*TMath::RadToDeg()-150)<10

group:
  - name: Analysis
    title: Analysis
    contents:      
#============================ Upstream PID 
    - name: PIDupstream
      title: PID updtream | PID(23F)
      x: [tof_US.fTiming, 500, -1490, -1420]
      y: [plaV1190_FH9.fCharge, 500, 5000, 6200]
      cut: gate.Test(0)
      
    - name: PIDupstream_2
      title: PID upstream | PID(23F)
      x: [pid_us.fAOQ, 500, 2, 3.5]
      y: [pid_us.fZ, 500, 1, 12]
      cut: gate.Test(0)
#============================ S0img
    - name: S0img_XY
      title: S0img | PID(23F)
      x: [S0img.fTrack.fX, 500, -50, 50]
      y: [S0img.fTrack.fY, 500, -50, 50]
      cut: gate.Test(0)
      
    - name: S0img_AX
      title: S0img | PID(23F)
      x: [S0img.fTrack.fX, 500, -50, 50]
      y: [S0img.fTrack.fA*1000, 500, -50, 50]
      cut: gate.Test(0)
      
    - name: S0img_BY
      title: S0img | PID(23F)
      x: [S0img.fTrack.fY, 500, -50, 50]
      y: [S0img.fTrack.fB*1000, 500, -50, 50]
      cut: gate.Test(0)
      
    - name: S0img_BA
      title: S0img | PID(23F)
      x: [S0img.fTrack.fA*1000, 500, -50, 50]
      y: [S0img.fTrack.fB*1000, 500, -50, 50]
      cut: gate.Test(0)
 
#============================ vertex
    - name: vertexZ
      title: Vertex.Z | PID(23F)
      x: [vertex.fZ, 300, -100, 200]
      cut: gate.Test(0)
      
    - name: vertexXY
      title: Vertex.XY | PID(23F)
      x: [vertex.fX, 300, -50, 50]
      y: [vertex.fY, 300, -50, 50]
      cut: gate.Test(0)
 
#============================ Downstream PID
    - name: S0D | PID(23F)
      title: QDC(S0D) vs Tof(FH9-S0D)
      x: [tof_DS.fTiming, 400, -72, -60]
      y: [plaV775.fCharge, 400,  200, 2200]
      cut: gate.Test(0) && plaV775.fID == 4
      
    - name: NyokiPID | PID(23F)
      title: QDC(Nyoki) vs Tof(S0D-Nyoki)
      x: [tof_D1.fTiming, 400, 25, 45]
      y: [nyoki.fCharge, 400, 500, 2200]
      cut: gate.Test(0)
      
    - name: PID_downstream
      title: PID Downstream | PID(23F)
      x: [pid_ds.fAOQ, 500, 2, 3.5]
      y: [pid_ds.fZ, 500, 1, 12]
      cut: gate.Test(0)      
      
    - name: NyokiQ_s1x
      title: Nyoki_Q vs s1x | PID(23F)
      x: [smwdc_S1.fTrack.fX, 400, -200, 600]
      y: [nyoki.fCharge, 400, 500, 2200]
      cut: gate.Test(0)
      
    - name: NyokiQ_s1x_2
      title: Nyoki_Q vs s1x | PID(23F)
      x: [smwdc_S1.fTrack.X(-32.5), 400, -200, 600]
      y: [nyoki.fCharge, 400, 500, 2200]
      cut: gate.Test(0)  
      
    - name: S1XY
      title: s1y vs s1x | PID(23F)
      x: [smwdc_S1.fTrack.fX, 400, -200, 600]
      y: [smwdc_S1.fTrack.fY, 400, -200, 200]
      cut: gate.Test(0)
    
    - name: S1XA
      title: s1a vs s1x | PID(23F)
      x: [smwdc_S1.fTrack.fX, 400, -200, 600]
      y: [smwdc_S1.fTrack.fA, 400, -3, 3]
      cut: gate.Test(0)
      
#============================ p2p
    - name: openAng
      title: openAng | common
      x: [(p2p.fRecoilL.Theta()+p2p.fRecoilR.Theta())*TMath::RadToDeg(), 100, 70, 95]
      cut: commonGate
      
    - name: openAng_2
      title: openAng | PID(23F) vertexZ tgt openPhi nyokiQ tof_D1
      x: [(p2p.fRecoilL.Theta()+p2p.fRecoilR.Theta())*TMath::RadToDeg(), 100, 70, 95]
      cut: commonGate & tgtGate & nyoki.fCharge>1000 & openPhiGate
      
    - name: openPhi
      title: openPhi | common
      x: [(TMath::Abs(p2p.fRecoilL.Phi()-p2p.fRecoilR.Phi()))*TMath::RadToDeg()-180, 100, -50, 50]
      cut: commonGate
 
   #------------ common = PID(23F) + vertexZ + tof_D1
    - name: Sp
      title: Sp | PID(23F) & |vertex.Z-10|<60 & |tof_D1-35|<10 = common
      x: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate
       
    - name: Sp_s1x
      title: Sp vs s1x | common
      x: [smwdc_S1.fTrack.fX, 100, -200, 500]
      y: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate  
      
    - name: Sp_s1x_2
      title: Sp vs s1x | common
      x: [smwdc_S1.fTrack.X(-32.5), 100, -200, 500]
      y: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate  
   #------------ common + crystal
    - name: Sp_tgt
      title: Sp | common & crystal
      x: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & tgtGate
    
    - name: Sp_s1x_tgt
      title: Sp vs s1x | common & crystal
      x: [smwdc_S1.fTrack.fX, 100, -200, 500]
      y: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & tgtGate
 
    - name: Sp_s1x_tgt_2
      title: Sp vs s1x | common & crystal
      x: [smwdc_S1.fTrack.X(-32.5), 100, -200, 500]
      y: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & tgtGate
   #------------ common + holder   
    - name: Sp_holder
      title: Sp | common & hoder
      x: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & holderGate
    
    - name: Sp_s1x_holder
      title: Sp vs s1x | common & holder
      x: [smwdc_S1.fTrack.fX, 100, -200, 500]
      y: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & holderGate
   
    - name: Sp_s1x_holder_2
      title: Sp vs s1x | common & holder
      x: [smwdc_S1.fTrack.X(-32.5), 100, -200, 500]
      y: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & holderGate
      
   #------------ common + crystal + nyokiQ 
    - name: Sp_tgt_nQ_openAng
      title: Sp | PID(23F) vertexZ tgt nyokiQ tof_D1
      x: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & tgtGate & nyoki.fCharge>1000
   
    - name: Sp_s1x_tgt_nQ
      title: Sp vs s1x | PID(23F) vertexZ tgt nyokiQ tof_D1
      x: [smwdc_S1.fTrack.fX, 100, -200, 500]
      y: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & tgtGate & nyoki.fCharge>1000
      
      
   #------------ common + crystal + nyokiQ + nyokiID
    - name: Sp_tgt_nQ_openAng_nID
      title: Sp | PID(23F) vertexZ tgt nyokiQ tof_D1 nyokiID
      x: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & tgtGate & nyoki.fCharge>1000 & abs(nyoki.fID-8)<3
    
    - name: Sp_s1x_tgt_nQ_nID
      title: Sp vs s1x | PID(23F) vertexZ tgt nyokiQ tof_D1 nyokiID
      x: [smwdc_S1.fTrack.fX, 100, -200, 500]
      y: ["p2p[0].fSp", 60, -20, 100]
      cut: commonGate & tgtGate &  nyoki.fCharge>1000 & abs(nyoki.fID-8)<3
